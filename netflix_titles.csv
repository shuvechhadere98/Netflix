Count the Number of Movies vs TV Shows,
,
"select show_type, count(*)",
from netflix,
group by show_type,
,
Output:,
show_type,count
Movie,6131
TV Show,2676
,
,
 Find the Most Common Rating for Movies and TV Shows,
,
with CTE as,
"(select show_type, rating, count(*),",
dense_rank () over(partition by show_type order by count(*) desc),
from netflix,
"group by 1, 2",
order by count(*) desc),
,
"select show_type, rating as most_frequent_rating",
from CTE,
where dense_rank = 1,
,
Output:,
type,most_frequent_rating
Movie,TV-MA
TV Show,TV-MA
,
List All Movies Released in 2020,
,
select title,
from netflix,
where show_type = 'Movie' and release_year = 2020,
,
Find the Top 5 Countries with the Most Content on Netflix,
,
"select country, count(show_id) as content_count",
from netflix,
where country is not null,
group by 1,
order by count(*) desc,
limit 5,
,
Identify the Longest Movie,
,
SELECT ,
    title,
FROM netflix,
WHERE show_type = 'Movie' and duration is not null,
"ORDER BY SPLIT_PART(duration, ' ', 1)::INT DESC",
limit 1,
,
Find Content Added in the Last 5 Years,
,
SELECT *,
FROM netflix,
"WHERE TO_DATE(date_added, 'Month DD, YYYY') >= CURRENT_DATE - INTERVAL '5 years';",
,
Find All Movies/TV Shows by Director 'Rajiv Chilaka',
,
SELECT *,
FROM netflix,
WHERE director like '%Rajiv Chilaka%',
,
List All TV Shows with More Than 5 Seasons,
,
select *,
from netflix,
where show_type = 'TV Show' and title is not null,
"and SPLIT_PART(duration, ' ', 1):: int > 5;",
,
Count the Number of Content Items in Each Genre,
,
SELECT ,
"    UNNEST(STRING_TO_ARRAY(listed_in, ',')) AS genre,",
    COUNT(*) AS total_content,
FROM netflix,
GROUP BY 1;,
,
Find each year and the average numbers of content release in India on netflix.,
,
SELECT ,
"    country,",
"    release_year,",
"    COUNT(show_id) AS total_release,",
    ROUND(,
        COUNT(show_id)::numeric /,
"        (SELECT COUNT(show_id) FROM netflix WHERE country = 'India')::numeric * 100, 2",
    ) AS avg_release,
FROM netflix,
WHERE country = 'India',
"GROUP BY country, release_year",
ORDER BY avg_release DESC,
LIMIT 5;,
,
List All Movies that are Documentaries,
,
SELECT *,
FROM netflix,
WHERE listed_in like '%Documentaries%';,
,
Find All Content Without a Director,
,
SELECT *,
FROM netflix,
WHERE director is null;,
,
Find How Many Movies Actor 'Salman Khan' Appeared in the Last 10 Years,
,
SELECT *,
FROM netflix,
WHERE casts like '%Salman Khan%',
and release_year >= extract(year from CURRENT_DATE) - 10;,
,
Find the Top 10 Actors Who Have Appeared in the Highest Number of Movies Produced in India,
,
SELECT ,
"    UNNEST(STRING_TO_ARRAY(casts, ',')) AS actor,",
    COUNT(*),
FROM netflix,
WHERE country = 'India',
GROUP BY actor,
ORDER BY COUNT(*) DESC,
LIMIT 10;        ,
,
Top 5 countries which has released the most number of shows,
,
"SELECT UNNEST(STRING_TO_ARRAY(country,',')) as Country, count(*) AS show_count",
FROM Netflix,
group by 1,
order by show_count desc,
limit 5,
